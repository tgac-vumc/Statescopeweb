"use strict";(self.webpackChunkStatescope=self.webpackChunkStatescope||[]).push([[3976],{2053:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>a,contentTitle:()=>l,default:()=>h,frontMatter:()=>r,metadata:()=>i,toc:()=>c});const i=JSON.parse('{"id":"intro","title":"Tutorial Intro","description":"Introduction","source":"@site/docs/intro.md","sourceDirName":".","slug":"/intro","permalink":"/docs/intro","draft":false,"unlisted":false,"editUrl":"https://github.com/tgac-vumc/Statescopeweb.git/docs/intro.md","tags":[],"version":"current","sidebarPosition":1,"frontMatter":{"id":"intro","title":"Tutorial Intro","sidebar_position":1}}');var o=s(4848),t=s(8453);const r={id:"intro",title:"Tutorial Intro",sidebar_position:1},l="How to Use the Snakemake Pipeline",a={},c=[{value:"Introduction",id:"introduction",level:2},{value:"Installation",id:"installation",level:2},{value:"Using Snakemake Pipelines",id:"using-snakemake-pipelines",level:2},{value:"Step 1: Running a Snakemake Workflow",id:"step-1-running-a-snakemake-workflow",level:3},{value:"Running Snakemake on SLURM",id:"running-snakemake-on-slurm",level:2},{value:"Step 1: Basic Command for SLURM",id:"step-1-basic-command-for-slurm",level:3},{value:"Explanation:",id:"explanation",level:3},{value:"Step 2: Configuring GPU Nodes",id:"step-2-configuring-gpu-nodes",level:3},{value:"Additional GPU Options:",id:"additional-gpu-options",level:3},{value:"Testing the Installation",id:"testing-the-installation",level:2},{value:"Additional Resources",id:"additional-resources",level:2}];function d(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,t.R)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(n.header,{children:(0,o.jsx)(n.h1,{id:"how-to-use-the-snakemake-pipeline",children:"How to Use the Snakemake Pipeline"})}),"\n",(0,o.jsx)(n.h2,{id:"introduction",children:"Introduction"}),"\n",(0,o.jsx)(n.p,{children:"Snakemake is a workflow management system that helps to create and manage complex workflows using Python. It\u2019s widely used in bioinformatics to automate the execution of tasks and can handle dependency resolution, workflow management, and more."}),"\n",(0,o.jsx)(n.hr,{}),"\n",(0,o.jsx)(n.h2,{id:"installation",children:"Installation"}),"\n",(0,o.jsx)(n.p,{children:"To install Snakemake, you need Python installed on your system. Snakemake can be installed via pip:"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:"pip install snakemake\n"})}),"\n",(0,o.jsxs)(n.p,{children:["To see the planned workflow without executing it, use the ",(0,o.jsx)(n.code,{children:"--dry-run"})," option:"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:"snakemake -s your_workflow.smk --dry-run\n"})}),"\n",(0,o.jsx)(n.hr,{}),"\n",(0,o.jsx)(n.h2,{id:"using-snakemake-pipelines",children:"Using Snakemake Pipelines"}),"\n",(0,o.jsx)(n.p,{children:"Snakemake is a workflow management system that allows you to run complex pipelines. Here\u2019s how to set up and use Snakemake with BLADE."}),"\n",(0,o.jsx)(n.h3,{id:"step-1-running-a-snakemake-workflow",children:"Step 1: Running a Snakemake Workflow"}),"\n",(0,o.jsxs)(n.ol,{children:["\n",(0,o.jsxs)(n.li,{children:["\n",(0,o.jsxs)(n.p,{children:[(0,o.jsx)(n.strong,{children:"Set up your workflow:"})," Ensure that you have the necessary files and configurations in place in the repository."]}),"\n"]}),"\n",(0,o.jsxs)(n.li,{children:["\n",(0,o.jsx)(n.p,{children:(0,o.jsx)(n.strong,{children:"Run the Snakemake pipeline:"})}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:"snakemake -s your_workflow.smk\n"})}),"\n",(0,o.jsxs)(n.p,{children:["Replace ",(0,o.jsx)(n.code,{children:"your_workflow.smk"})," with the specific Snakemake file you are using. This command will execute the pipeline defined in the Snakemake workflow file."]}),"\n"]}),"\n"]}),"\n",(0,o.jsx)(n.hr,{}),"\n",(0,o.jsx)(n.h2,{id:"running-snakemake-on-slurm",children:"Running Snakemake on SLURM"}),"\n",(0,o.jsxs)(n.p,{children:["To run Snakemake on a SLURM-managed cluster, use the ",(0,o.jsx)(n.code,{children:"--cluster"})," option. This allows you to submit jobs to SLURM with specific resource requirements."]}),"\n",(0,o.jsx)(n.h3,{id:"step-1-basic-command-for-slurm",children:"Step 1: Basic Command for SLURM"}),"\n",(0,o.jsx)(n.p,{children:"Here\u2019s how to run the Snakemake pipeline with SLURM:"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:'snakemake -s Snakefile4 \\\n    --cluster "sbatch --job-name={rule} --cpus-per-task={threads} --mem={resources.mem_mb} --output=logs/%x-%j.out --error=logs/%x-%j.err --mail-type=BEGIN,END,FAIL --mail-user=a.bose1@amsterdamumc.nl" \\\n    --default-resources mem_mb=100000 threads=1 \\\n    --use-conda \\\n    --jobs 20 \\\n    -p \\\n    --keep-going\n'})}),"\n",(0,o.jsx)(n.h3,{id:"explanation",children:"Explanation:"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:(0,o.jsx)(n.code,{children:"-s Snakefile4"})}),": Specifies the Snakemake workflow file to run."]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:(0,o.jsx)(n.code,{children:"--cluster"})}),": Specifies the SLURM submission command.","\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:(0,o.jsx)(n.code,{children:"--job-name={rule}"})}),": Names the SLURM job after the Snakemake rule."]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:(0,o.jsx)(n.code,{children:"--cpus-per-task={threads}"})}),": Allocates threads based on the rule definition."]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:(0,o.jsx)(n.code,{children:"--mem={resources.mem_mb}"})}),": Requests memory (in MB) for each job."]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:(0,o.jsx)(n.code,{children:"--output"})})," and ",(0,o.jsx)(n.strong,{children:(0,o.jsx)(n.code,{children:"--error"})}),": Specify log file paths for output and errors."]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:(0,o.jsx)(n.code,{children:"--mail-type=BEGIN,END,FAIL"})}),": Configures SLURM to send email notifications at the start, end, or if the job fails."]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:(0,o.jsx)(n.code,{children:"--mail-user=a.bose1@amsterdamumc.nl"})}),": Sets the email recipient for notifications."]}),"\n"]}),"\n"]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:(0,o.jsx)(n.code,{children:"--default-resources mem_mb=100000 threads=1"})}),": Sets default resources for rules that don\u2019t specify them."]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:(0,o.jsx)(n.code,{children:"--use-conda"})}),": Ensures that Snakemake uses Conda environments defined in the workflow."]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:(0,o.jsx)(n.code,{children:"--jobs 20"})}),": Allows a maximum of 20 jobs to be submitted in parallel."]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:(0,o.jsx)(n.code,{children:"-p"})}),": Prints shell commands as they are executed."]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:(0,o.jsx)(n.code,{children:"--keep-going"})}),": Continues running the workflow even if some jobs fail."]}),"\n"]}),"\n",(0,o.jsx)(n.hr,{}),"\n",(0,o.jsx)(n.h3,{id:"step-2-configuring-gpu-nodes",children:"Step 2: Configuring GPU Nodes"}),"\n",(0,o.jsxs)(n.p,{children:["To run on GPU nodes, include GPU-specific resource requests in the ",(0,o.jsx)(n.code,{children:"--cluster"})," command:"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:'snakemake -s Snakefile4 \\\n    --cluster "sbatch --job-name={rule} --cpus-per-task={threads} --mem={resources.mem_mb} --gres=gpu:1 --output=logs/%x-%j.out --error=logs/%x-%j.err --mail-type=BEGIN,END,FAIL --mail-user=a.bose1@amsterdamumc.nl" \\\n    --default-resources mem_mb=100000 threads=1 \\\n    --use-conda \\\n    --jobs 10 \\\n    -p \\\n    --keep-going\n'})}),"\n",(0,o.jsx)(n.h3,{id:"additional-gpu-options",children:"Additional GPU Options:"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:(0,o.jsx)(n.code,{children:"--gres=gpu:1"})}),": Requests one GPU for each job."]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:(0,o.jsx)(n.code,{children:"--partition=gpu"})}),": If your cluster has a specific GPU partition, include this flag."]}),"\n"]}),"\n",(0,o.jsx)(n.hr,{}),"\n",(0,o.jsx)(n.h2,{id:"testing-the-installation",children:"Testing the Installation"}),"\n",(0,o.jsxs)(n.p,{children:["After completing the installation steps, it is recommended to run a test workflow to ensure that everything is set up correctly. Follow the instructions in the ",(0,o.jsx)(n.code,{children:"tests"})," directory of the repository to execute sample pipelines and verify the installation."]}),"\n",(0,o.jsx)(n.hr,{}),"\n",(0,o.jsx)(n.h2,{id:"additional-resources",children:"Additional Resources"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsx)(n.li,{children:(0,o.jsx)(n.a,{href:"https://github.com/aryamaanbose/BLADE_tasks/wiki",children:"BLADE Documentation"})}),"\n",(0,o.jsx)(n.li,{children:(0,o.jsx)(n.a,{href:"https://docs.conda.io/",children:"Conda Documentation"})}),"\n",(0,o.jsx)(n.li,{children:(0,o.jsx)(n.a,{href:"https://snakemake.readthedocs.io/",children:"Snakemake Documentation"})}),"\n"]}),"\n",(0,o.jsx)(n.hr,{}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{})})]})}function h(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,o.jsx)(n,{...e,children:(0,o.jsx)(d,{...e})}):d(e)}},8453:(e,n,s)=>{s.d(n,{R:()=>r,x:()=>l});var i=s(6540);const o={},t=i.createContext(o);function r(e){const n=i.useContext(t);return i.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:r(e.components),i.createElement(t.Provider,{value:n},e.children)}}}]);